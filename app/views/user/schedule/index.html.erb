<section id="calendar_section">
<div class="container">
	<div class="row pad_top">
		<div class="col-xs-12 col-md-8 pad_top">

			<div id="calendar" class="panel panel-default">
				<div class="panel-heading">
					<button id="prev_month" class="btn btn-default cal_nav">
						 <span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span>
					</button>
					<h4 id="month" class="panel-title sans_serif_bold dark_text"></h4>
					<button id="next_month" class="btn btn-default cal_nav">
						<span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
					</button>
				</div>
				<div class="table-responsive">
					<table class="table table-bordered">
						<thead>
							<tr>
								<th class="sans_serif_bod dark_text">Sun.</th>
								<th class="sans_serif_bod dark_text">Mon.</th>
								<th class="sans_serif_bod dark_text">Tue.</th>
								<th class="sans_serif_bod dark_text">Wed.</th>
								<th class="sans_serif_bod dark_text">Thu.</th>
								<th class="sans_serif_bod dark_text">Fri.</th>
								<th class="sans_serif_bod dark_text">Sat.</th>
							</tr>
						</thead>
						<tbody id="calendar_body">

						</tbody>
					</table>
				</div>
			</div>


		</div>
		<div class="col-xs-12 col-md-4 pad_top">
			<div class="row">
				<div class="col-xs-12">
					<%= link_to user_notifications_new_appointments_path, :class => 'quick_action_link' do %>
						<div class="quick_action_small">
							<span class="not light_text"><%= @appointment_notifications.count %></span>
							<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
							<h4 class="sans_serif_bold dark_text">New Appointments</h4>
						</div>
					<% end %>
				</div>

			</div>
			<div class="row pad_top">
				<div class="col-xs-12">
					<%= render :partial => "shared/events_list.html.erb" %>
				</div>
			</div>
			
		</div>
	</div>
	
	
</div>
</section>
<%= javascript_tag do %>
	$('document').ready(function() {
		var events = createEventsObj(<%= raw @events.to_json %>);
		var today = new Date();
		init(today, events);
		$('#prev_month').click(function() {
			if(today.getMonth() === 0) {
				today.setMonth(11);
				today.setYear(today.getFullYear() - 1);
			}
			else {
				today.setMonth(today.getMonth() - 1);
			}
			init(today, events);
		});
		$('#next_month').click(function() {
			if(today.getMonth() === 11) {
				today.setMonth(0);
				today.setYear(today.getFullYear() + 1)
			}
			else {
				today.setMonth(today.getMonth() +1);
			}
			init(today, events);
		});
		$('td').each(function(index) {
			var td_id = $(this).attr('id');
			$(this).click(function() {
				$.ajax({url: '<%= user_schedule_retrieve_events_path %>',
					data: 'date='+td_id,
					dataType: 'script'});
			});
			
		});
		getProfileColors(<%= raw @colors.to_json %>);
	});	
	
<% end %>