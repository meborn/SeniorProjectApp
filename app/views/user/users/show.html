<section id="welcome_section">
	<div class="container">
		<div class="row">

			<div class="col-xs-12 col-md-8">
				<div class="row">
					<div class="col-xs-4 col-sm-3 col-md-4 col-lg-3">
						<div class="thumbnail">
							<% if @user.avatar.content_type %>
								<%= image_tag @user.avatar.url(:small), :class => 'user_avatar' %>
							<% else %>
								<%= image_tag 'user_avatar_thumb.png', :class => 'user_avatar' %>
							<% end %>
							<div class="caption text-center">
								<a href="#" class="ninja_link">Edit</a>
							</div>
						</div>	
					</div>
					<div class="col-xs-8 col-sm-9 col-md-8 col-lg-9">
						<h1 class="sans_serif_bold dark_text">Hello<span class="sans_serif_bold">
							<%= @user.name %></span>!
						</h1>
						<h4><em><%= @user.email %></em></h4>
					</div>
				</div>
			</div>

			<div class="col-xs-12 col-md-4">
				<div class="panel panel-default">
					<div class="panel-heading">
						<%= link_to user_notifications_path do %>
							<h2 class="panel-title dashboard_header">Notifications</h2>
						<% end %>
					</div>
					<ul class="list-group">
						<li class="list-group-item">
							<%= link_to user_notifications_new_appointments_path do %>
								New Appointments <span class="badge"><%= @appointment_notifications.count %></span>
							<% end %>
						</li>
						<li class="list-group-item">
							<%= link_to user_clients_path do %>
								New Clients <span class="badge"><%= @client_notifications.count %></span>
							<% end %>
						</li>
						<li class="list-group-item">
							<a href="#">
								New Venders <span class="badge"><%= @vender_notifications.count %></span>
							</a>
						</li>
						<li class="list-group-item">
							<a href="#">
								New Reviews <span class="badge">42</span>
							</a>
						</li>
					</ul>
				</div>
			</div>

		</div>
	</div>

</section>

<div class="row">
	<div class="col-xs-12 col-md-8">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h2 class="panel-title dashboard_header"><%= @today_start.strftime('%A, %B %d, %Y') %></h2>
				<%= link_to "&#43 Opening".html_safe, new_user_opening_path, :class=> 'dashboard_link'%>	
			</div>
			<ul class="list-group">
				<% if !@schedule.empty? %>
					<% @schedule.each do |s| %>
						<li class="list-group-item">
							<% if @openings.include? s %>
								<%= link_to(user_opening_path(s)) do %>
									<div class="row">
										<div class="col-xs-12 col-sm-6 col-md-6">
												<span class='profile_color profile_color_<%= s.profile.title.gsub(/\s+/,"")%>'></span>
												<div class="small_profile_title">
													<p><%= s.profile.title %></p>
													<em class="text-success">Available</em>
												</div>
										</div>
										<div class="col-xs-12 col-sm-6 col-md-6">
												<%= s.start.strftime('%I:%M')%> - <%= s.end.strftime('%I:%M %P') %>
										</div>
									</div>
								<% end %>
							<% elsif @client_appointments.include? s %>
								<%= link_to(user_appointment_path(s)) do %>
									<div class="row">
										<div class="col-xs-12 col-sm-6 col-md-6">
												<% if s.profile.avatar.content_type %>
													<%= image_tag s.profile.avatar.url(:thuumb), :class => "xs_profile_avatar" %>
												<% end %>
												<div class="small_profile_title">
													<p><%= s.profile.title %></p>
													<em class="text-success"><%= s.profile.user.email %></em>
												</div>
										</div>
										<div class="col-xs-12 col-sm-6 col-md-6">
												<%= s.start.strftime('%I:%M')%> - <%= s.end.strftime('%I:%M %P') %>
										</div>
									</div>
								<% end %>
							<% else %>
								<%= link_to(user_appointment_path(s)) do %>
										<div class="row">
											<div class="col-xs-12 col-sm-6 col-md-6">
												<span class='glyphicon glyphicon-ok glyph_color profile_color_<%= s.profile.title.gsub(/\s+/,"")%>' aria-hidden="true"></span>
												<div class="small_profile_title">
													<p><%= s.profile.title %></p>
													<% if s.client != @user %>
														<em class="text-warning"><%= s.client.email %></em>
													<% end %>
													
												</div>
											</div>
											<div class="col-xs-12 col-sm-6 col-md-6">
												<%= s.start.strftime('%I:%M')%> - <%= s.end.strftime('%I:%M %P') %>
											</div>
										</div>
								<% end %>
							<% end %>
						</li>
					<% end %>
				<% else %>
					<li class="list-group-item">
						<div class="alert alert-danger">
							No events scheduled for today.
						</div>
					</li>
				<% end %>
			</ul>
		</div>
	</div>
	<div class="col-xs-12 col-md-4">
		
		<div class="panel panel-default">
			<div class="panel-heading">
				<%= link_to user_notifications_path do %>
					<h2 class="panel-title dashboard_header">Notifications</h2>
				<% end %>
			</div>
			<ul class="list-group">
				<li class="list-group-item">
					<%= link_to user_notifications_new_appointments_path do %>
						New Appointments <span class="badge"><%= @appointment_notifications.count %></span>
					<% end %>
				</li>
				<li class="list-group-item">
					<%= link_to user_clients_path do %>
						New Clients <span class="badge"><%= @client_notifications.count %></span>
					<% end %>
				</li>
				<li class="list-group-item">
					<a href="#">
						New Venders <span class="badge"><%= @vender_notifications.count %></span>
					</a>
				</li>
				<li class="list-group-item">
					<a href="#">
						New Reviews <span class="badge">42</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h2 class="panel-title dashboard_header">My Profiles</h2>
				<%= link_to "&#43 Profile".html_safe, new_user_profile_path, :class => "dashboard_link"%>
			</div>
			<ul class="list-group">
					<% @profiles.each do |profile| %>
						<%= link_to user_profile_path(profile) do %>
							<li class="list-group-item">
								<% if profile.avatar.content_type %>
									<%= image_tag profile.avatar.url(:thuumb) %>
								<% end %>
								<strong><%= profile.title %></strong>
							</li>
						<% end %>
					<% end %>
					<% if @profiles.count == 0 %>
						<div class="panel-body">
							<div class="alert alert-danger">
								You don't have any profiles yet.
							</div>
						</div>
					<% end %>
			</ul>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h2 class="panel-title dashboard_header">Vender Profiles</h2>
				<%= link_to "Find Me!", profiles_path, :class => 'dashboard_link' %>
			</div>
			<ul class="list-group">
					<% @user_is_client.each do |p| %>
						<li class="list-group-item">
							<% if p.profile.avatar.content_type %>
								<%= image_tag p.profile.avatar.url(:thuumb) %>
							<% end %>
							<strong><%= p.profile.title %></strong>
						</li>
						
					<% end %>
					<% if @user_is_client.count == 0 %>
						<div class="panel-body">
							<div class="alert alert-danger">
								You don't have any venders yet.
							</div>
						</div>
					<% end %>
			</ul>
		</div>
	</div>
</div>

<% @profiles.each do |profile| %>
	<script>
		$('.<%= profile.title.gsub(/\s+/,"") %>').css('border', '2px solid <%= profile.color %>');
		$('.profile_color.profile_color_<%= profile.title.gsub(/\s+/,"")%>').css('border', '1px solid <%= profile.color %>');
		$('.a_profile_color.profile_color_<%= profile.title.gsub(/\s+/,"")%>').css('background-color', '<%= profile.color %>');
		$('.b_profile_color.profile_color_<%= profile.title.gsub(/\s+/,"")%>').css('border', '1px solid <%= profile.color %>');
		$('span.glyph_color.profile_color_<%= profile.title.gsub(/\s+/,"")%>').css('color', '<%= profile.color %>');

		$('td').click(function() {
			$(this).find('form').submit();
		});
	</script>
<% end %>
